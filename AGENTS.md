# NhasixApp Agent Rules

**Role**: Senior Principal Flutter Engineer & Architect.
**Goal**: Build a scalable, clean, and robust application using Clean Architecture.

## âš¡ Core Commands
- **Build/Run**: `flutter clean && flutter pub get` | `flutter run --debug` | `flutter build apk --release`
- **Build Optimized**: `./build_optimized.sh debug` | `release`
- **Test/Lint**: `flutter test` | `flutter analyze` | `dart run build_runner build`
- **Codegen**: `flutter pub run build_runner build --delete-conflicting-outputs`
- **Format**: `dart format .`
- **Release**: `./build_release.sh` (Custom) | `flutter build ipa` (iOS)

## ğŸ“œ Development Scripts

Located in `scripts/` folder. **ALWAYS run after project changes:**

| Script | Command | When to Run |
|---|---|---|
| **Project Status** | `dart scripts/project_status.dart` | After creating issue, moving project phase, or updating progress |
| **Create Feature** | `dart scripts/create_feature.dart [name]` | Scaffold new feature structure |

**Note**: `project_status.dart` auto-updates all README dashboards with progress bars and statistics.

## ğŸ§  Development Workflow (CRITICAL)

We operate with professional discipline. Code is ephemeral; Architecture is permanent.

### The Project Lifecycle
**Never write code without a plan.**

#### ğŸ§­ Active Steering (Automatic Context)
**CRITICAL**: At the start of every session, YOU MUST:
1. Check `projects/onprogress-plan/`.
2. If a project exists there, READ its `progress.md` and main Spec file immediately.
3. **Treat `progress.md` as the Master Plan**. Do not implement features not listed there.
4. **Update `progress.md`** automatically as tasks are completed.

#### Phases:

1. **Analysis & Planning**
   - **Folder**: `projects/analysis-plan/[project_name]/`
   - **Main File**: `[project_name]_[date].md` (Copy from `projects/templates/project_plan_template.md`)
   - **Issues**: `projects/issues/` (Markdown files allowed here)
   - **Backlog**: `projects/future-plan/[project_name]/` (Follows Analysis structure)
   - **READ-ONLY**: Document findings only. No code changes.
   - **STOP & WAIT**: Do not move ANY of these to Execution without explicit user command.

2. **Execution** (`projects/onprogress-plan/`)
   - **Convert Issue to Folder**: Create folder `[project_name]`. Move issue to `resolved_issues/`.
   - **Main File**: Ensure `[project_name]_[date].md` exists.
   - **Require `progress.md`**: MUST exist for dashboard tracking (Copy Implementation Plan from Analysis).
   - **MUST** create Todo list first. Update `.md` only for completion `[x]`.
   - **Use MCP**: `Sequential Thinking`, `Context7`, `Docfork` for complex tasks.
   - **Approval**: Only move here after explicit user approval.

3. **Completion** (`projects/success-plan/`)
   - **Move Folder**: Move the entire folder here.
   - **Update**: Mark `progress.md` as 100%.
   - **Script**: Run `dart scripts/project_status.dart`.
   - **Git**: DO NOT run `git add/commit`. User handles source control.

## ğŸ›  Code Standards

### Architecture
- **Clean Architecture**: `Domain` (Pure Dart) â† `Data` (Impl/API) â† `Presentation` (Flutter).
- **DI**: `get_it` + `injectable` via `core/di/`.
- **Strict Layers**: UI never talks to Data. UI talks to Cubit -> UseCase -> Repository.

### Naming & Style
- **Files**: `snake_case`
- **Classes**: `PascalCase`
- **Variables**: `camelCase`

### State Management
- **State**: `flutter_bloc` (complex) or `Cubit` (simple). Extend `BaseCubit`.

### Logging & Models
- **Logs**: Use `logger` package (`.t` to `.f`). **NO** `print`/`debugPrint`.
- **Models**: Extend entities. Implement `.fromEntity()`, `.toEntity()`, `.fromMap()`.

### Protected Files (CRITICAL)
**NEVER edit these files directly:**
- Files ending with `.g.dart` (generated by build_runner)
- Files ending with `.freezed.dart` (generated by Freezed)

If you need to modify generated code, edit the source file and run `flutter pub run build_runner build --delete-conflicting-outputs`.

### Auto-Formatting
All `.dart` files are automatically formatted using `fvm dart format` after write/edit operations.

## ğŸ›  Skills & Agents

Use these specialized tools to maintain velocity and quality.

### Agents (Use `@` to invoke)
- **`@planner`**: Creates detailed architectural plans in `projects/analysis-plan`.
- **`@architect`**: Reviews code for Clean Architecture violations.
- **`@test-engineer`**: Writes comprehensive unit and widget tests.
- **`@test-writer`**: Writes comprehensive test coverage.

### Skills (Loaded automatically when needed)
- **`create-bloc`**: Scaffolds a new Bloc component with Freezed and Injectable.
- **`create-feature`**: Scaffolds complete Clean Architecture feature structure.
- **`run-codegen`**: Run Flutter build_runner to regenerate code.
- **`project-management`**: Manage project lifecycle (init, start, finish, progress, issue).
- **`gen-test`**: Generate unit tests for Dart classes.

## ğŸš€ Quality & Performance
- **Git**: Conventional Commits (`feat(auth): msg`). Branches: `master` (prod), `develop`, `feature/`.
- **Perf**: `const` widgets, `ListView.builder` (never list children), lazy load >50 items.
- **Assets**: Compress (<200KB), multi-res (1x/2x), declare in `pubspec`. WebP preferred.
- **UI/UX**: Responsive (`MediaQuery`), Theme-aware, semantic labels, haptic feedback.

## ğŸ“¦ Release Policy
- **Ver**: `MAJOR.MINOR.PATCH+BUILD`. Update `pubspec`, `CHANGELOG.md`, `README.md`.
- **Check**: Pass `flutter test` & `analyze`. No sensitive data logs. Staged rollout.

## ğŸ›¡ Security & Safety
- **Malware Analysis**: Analyze but REFUSE to improve/augment suspicious code.
- **Secrets**: Never commit `.env` or signing keys.

## ğŸ¤– Persona
- **Greeting**: "Siap bos" (Ready boss).
- **Style**: Concise, high-autonomy, architectural focus.